<glava></glava>

<main role='main', style='background-color: #ffffff'>
  <div class='container'>
    <div class='row'>
      <div class='col-md-7'>
        <div class='card mb-4 shadow-sm'>
          <div ng-if="vm.post.body.bodyType == 'image'">
            <div ng-if="vm.post.body.content != undefined">
              <div ng-if="vm.post.body.content == '' ">
                <img class='card-img-top', src='../resources/A_01.jpg', alt='Card image cap'>
              </div>
              <div ng-if="vm.post.body.content">
                <img class='card-img-top', src="{{vm.post.body.content}}", alt='Card image cap'>
              </div>
            </div>
          </div>
          <div ng-if="vm.post.body.bodyType == 'embed'">
            <div ng-if="vm.post.body.content != undefined">
              <div ng-if="vm.post.body.content == '' ">
                <img class='card-img-top', src='../resources/A_01.jpg', alt='Card image cap'>
              </div>
              <div ng-if="vm.post.body.content">
                <iframe width="100%" height="120" src="{{vm.post.body.content}}" frameborder="0" ></iframe>
              </div>
            </div>
          </div>
          <div ng-if="vm.post.body.bodyType == 'text'">
          </div>
          <div class='card-body', style='background-color: #ffffff;'>
            <div class="d-flex justify-content-between align-items-center">
              <h3> {{vm.post.title}} </h3>
              <small class="text-muted">{{vm.post.likes}}</small>
            </div>
            
            <div ng-repeat="up in vm.users">
              <div ng-if="up._id == vm.post.owner">
                <a href = '/users/{{up._id}}', class="card-user">
                  <h5>{{up.username}}</h5>
                </a>
              </div>
            </div>
            <p class='card-text'>
              {{vm.post.description}}
            </p>
            <p class='card-text'>
              <div >
                <b ng-repeat="tags in vm.post.hashtags">{{tags}} </b>
              </div>
            </p>
            <div ng-if="rootUser">
              <div ng-if="rootUser._id == vm.post.owner">
                <a href="/editPost/{{vm.post._id}}" >Edit</a>
                <a href="#myModal" data-toggle="modal">Delete</a>
            </div>
                      
              <div id="myModal" class="modal fade">
                  	<div class="modal-dialog modal-confirm">
                  		<div class="modal-content">
                  			<div class="text-center">
                  				<h4 class="modal-title">Are you sure?</h4>	
                          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  			</div>
                  			<div class="modal-body">
                  				<p>Do you really want to delete this picture? This process cannot be undone.</p>
                  			</div>
                  			<div class="text-center">
                  				<form ng-submit="vm.izbrisiPost(rootUser._id)" method="DELETE">
                  				  <button type="button" class="btn btn-info" data-dismiss="modal">Cancel</button>
                  				  <button id="gumb" type="submit" class="btn btn-danger">Delete</button>
                  				</form>
                  			</div>
                  		</div>
                  	</div>
                  </div> 
              <!--<button href="/editPost/{{vm.post._id}}" class="btn btn-outline-dark my-2 my-sm-0" type="button"> Edit
              <button class="btn btn-outline-dark my-2 my-sm-0" type="button"> Delete
               
               <div class="dropdown">
                <button class="btn" type="button" data-toggle="dropdown" style="background-color: #ffffff;">
                  Options
                  <span class="glyphicon glyphicon-option-horizontal"></span>
                </button>
                <ul class="dropdown-menu">
                    <li><a href="#myModal" data-toggle="modal">Delete</a></li>
                    <li><a href="/posts/postID/editPost">Edit</a></li>
                </ul>
              </div>
             <div class="modal fade" id="myModal">
                  <div class="modal-dialog modal-confirm">
                      <div class="modal-content">
                          <div class="text-center">
                              <h4 class="modal-title">Are you sure?</h4><button class="close" type="button" data-dismiss="modal" aria-hidden="true">&times;</button></div>
                          <div class="modal-body">
                              <p>Do you really want to delete this picture? This process cannot be undone.</p>
                          </div>
                          <div class="text-center"><button class="btn btn-info" type="button" data-dismiss="modal">Cancel</button>
                              <form method="POST" action="povezava"><button class="btn btn-danger" type="submit">Delete</button></form>
                          </div>
                      </div>
                  </div>
              </div>-->
              
              <!--<div class="dropdown">
                <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Dropdown Example
                <span class="caret"></span></button>
                <ul class="dropdown-menu">
                  <li><a href="#">HTML</a></li>
                  <li><a href="#">CSS</a></li>
                  <li><a href="#">JavaScript</a></li>
                </ul>
              </div>-->
              <div ng-if="vm.response == 'success'" class="alert alert-info">Post izbrisan!</div>
              <div ng-if="vm.response == 'error'" class="alert alert-danger">Napaka pri brisanju!</div>
              <div ng-if="vm.response == 'errorUser'" class="alert alert-danger">Napaka pri posodabljanju uporabnika!</div>
            </div>
            
            <p>
              <h4>Comments</h4>
            </p>
            <div ng-if="rootUser">
              <form ng-submit="vm.dodajComment(rootUser)" method="PUT">
                <!--<textarea class="form-control" id="exampleFormControlTextarea1" rows="3" name="textarea"></textarea>-->
                <textarea ng-model="vm.comment" class="form-control" id="comment" name="comment" rows="3" required>{{vm.comment}}</textarea> 
                 <div ng-if="vm.desRes == 'success'" class="alert alert-info">Komentar objavljen</div>
                <div ng-if="vm.desRes == 'true'" class="alert alert-warning">Med 1 in 500 znakov</div>
                <div ng-if="vm.desRes == 'err'" class="alert alert-danger">Napaka!</div>
                <br/>
                <button class="btn" id="gumb" type="submit" style="align: left;">Post</button>
              </form>
            </div>
            <div>
              <hr></hr>
              <div ng-if="vm.post.comments != undefined && vm.post.comments.length > 0">
                <div ng-repeat="comm in vm.post.comments">
                  <div ng-repeat="up in vm.users">
                    <div ng-if="up._id == comm.owner">
                      <a href='/users/{{comm.owner}}', class="card-user">
                        <h6>{{up.username}}</h6>
                      </a>
                      <p>{{comm.content}}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div>
    </div>
  </div>    
</main>